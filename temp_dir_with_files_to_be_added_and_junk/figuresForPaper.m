% the number of reads per sample 
clear
dirName = '~/CS/BAC/12Samples/454/data';

samples = {'S1','S2','S3','S4','O7','O10','S7','S10'};

clear numReads
for i=1:length(samples)
  clear unique*
  load([dirName,'/reads_samples_',samples{i},'_andMatch_basedFullDataBaseOf350WithAmbiguous']);
  numReads(i) = sum(uniqueReads_length);
end

dirName = '~/CS/BAC/12Samples/Solexa/data';
clear numReads best*
for i=1:length(samples)
  clear unique*
  %load([dirName,'/data_NO_OPT3_opt3_MergeForwardReverse_',samples{i}]);
  %load([dirName,'/data_opt3_MergeForwardReverse_',samples{i}])
  
  %load([dirName,'/with_or_without_equalization/illumina_reads100_',samples{i},'_uni_corrfreq'])
  numReads(i) = sum(uniqueReads_length);
  
  
end

  % March 03
  
  load([dirName,'/ignoreTail/readsSolexa_WITH_REVERSE_100_sample_',samples{i}])
  load([dirName,'/primer_tail/illumina_reads100_',samples{i},'_uni_primer_tail_noR'])
  

%%%%%%%%%%%
% number of reads for Shay
clear
dirName = '~/CS/BAC/12Samples/Solexa/data';

samples = {'S1','S2','S3','S4','O7','O10','S7','S10'};
clear numReads*
for i=1:2
  clear freq*
  load([dirName,'/ignoreTail/readsSolexa_WITH_REVERSE_100_sample_',samples{i}])
  numReads_noTail(i) =  sum(uniqueReads_length);
  
  load([dirName,'/primer_tail/illumina_reads100_',samples{i},'_uni_primer_tail_noR'])
  w = ['numReads_noTail(i) = sum(freq_uni_reads100_',samples{i},');'];
  eval(w)

  numReads_withTail(i) = sum(uniqueReads_length);
end


% find the number of reads mapped to Acetobacter - create the matrix based on the solution and find each

clear
S2 = load('~/CS/BAC/12Samples/Solexa/results/window_90_withNor_MergeForwardAndReverse/resWeightedMatrixBased_test_window_90_withNor_MergeForwardAndReverse_normReadsf_S2');

load /home/csfaculty/shental/CS/BAC/primers750_primer_tail/bac16s_primers750_primer_tail_full_without_ambiguous

ac = {'4452 D30768.1 Acetobacter aceti str. JCM 7641',...
'65495 ',...
'274161 ',...
'58371 '};

% find the Acetobacter in S2
clear S2_ind
for i=1:length(ac)
  a = ac{i};
  b = find(a==' ');
  a =  a(1:b(1)-1);
  for j=1:length(S2.tmpInd)
    for k=1:length(Header_750_tail{S2.tmpInd(j)})
      if ~isempty(findstr(Header_750_tail{S2.tmpInd(j)}{k},a))
        S2_ind(i) = j;
      end
    end
  end
end

sub = S2.matrix(:,S2_ind);

other = 1:size(S2.matrix,2);
other(S2_ind) = [];

% find the fraction of ac reads out of the total
y_ac = S2.matrix(:,S2_ind)*abs(S2.freqWeightedMatrix(S2_ind));
y_other = S2.matrix(:,other)*abs(S2.freqWeightedMatrix(other));
sum(y_ac)/(sum(y_ac)+sum(y_other))


ac_related_kmers = find(y_ac); % non zero ac reads

% find the number of reads mapped to other bacteria in S2 vs to ac 
[x,y] = find(S2.matrix(ac_related_kmers,:)); 

u = unique(y);
for i=1:length(u)
  tmp_y(:,i) = S2.matrix(:,u(i))*abs(S2.freqWeightedMatrix(u(i)));
end

sum(tmp_y)./(sum(y_ac)+sum(y_other))

sum(tmp_y(:,[2:4,6]))
sum(tmp_y(:,[1,5,7:8]))
%%%%%%%%%%%%

% find ac reads in S1
S1 = load('~/CS/BAC/12Samples/Solexa/results/window_90_withNor_MergeForwardAndReverse/resWeightedMatrixBased_test_window_90_withNor_MergeForwardAndReverse_normReadsf_S1');

[junk,i1,i2] = intersect(S1.values,S2.values(ac_related_kmers,:),'rows');
sum(S1.fracRelevantReads(i1)) % none are mapped to ac
% how many unique reads


% find the number of reads (unnormalized) that are mapped to ac - S1

dirName = '~/CS/BAC/12Samples/Solexa/data';
un_S1 = load([dirName,'/primer_tail/illumina_reads100_S1_uni_primer_tail_noR'])

numReads = size(un_S1.uni_reads100_S1,1);
read_S1_90 = char(zeros(11*numReads,90));
num_read_S1_90 = zeros(11*numReads,1);
k = 1;
for i=1:length(un_S1.freq_uni_reads100_S1)
  for j=1:11
    read_S1_90(k,:) = un_S1.uni_reads100_S1(i,j:j+89);
    num_read_S1_90(k) = un_S1.freq_uni_reads100_S1(i);
    k = k+1;
  end
end

packed_un_S1 = pack_seqs(read_S1_90,64);
[sort_packed_un_S1,index_sort] = sortrows(packed_un_S1);
sorted_num_read_S1_90 = num_read_S1_90(index_sort);

[u_sort_packed_un_S1,i1_first] = unique(sort_packed_un_S1,'rows','first');
[junk,i1_last] =  unique(sort_packed_un_S1,'rows','last');
num_sort_packed_un_S1 = i1_last-i1_first+1;

total_num_reads_sorted = zeros(1,length(i1_last));
for i=1:length(i1_last)
  total_num_reads_sorted(i) = sum(sorted_num_read_S1_90(i1_first(i):i1_last(i)));
end

  
[junk,i1,i2] = intersect(u_sort_packed_un_S1,S2.values(ac_related_kmers,:),'rows');
sum(total_num_reads_sorted(i1))/sum(total_num_reads_sorted)

% about 0.0171% of the raw reads are ac

%%%%%%%% end S1

% find the number of reads (unnormalized) that are mapped to ac - S1: take the reads tranform them to 90 and check intersection with ac reads

dirName = '~/CS/BAC/12Samples/Solexa/data';
un_S2 = load([dirName,'/primer_tail/illumina_reads100_S2_uni_primer_tail_noR'])

numReads = size(un_S2.uni_reads100_S2,1);
read_S2_90 = char(zeros(11*numReads,90));
num_read_S2_90 = zeros(11*numReads,1);
k = 1;
for i=1:length(un_S2.freq_uni_reads100_S2)
  for j=1:11
    read_S2_90(k,:) = un_S2.uni_reads100_S2(i,j:j+89);
    num_read_S2_90(k) = un_S2.freq_uni_reads100_S2(i);
    k = k+1;
  end
end

packed_un_S2 = pack_seqs(read_S2_90,64);
[sort_packed_un_S2,index_sort] = sortrows(packed_un_S2);
sorted_num_read_S2_90 = num_read_S2_90(index_sort);

[u_sort_packed_un_S2,i1_first] = unique(sort_packed_un_S2,'rows','first');
[junk,i1_last] =  unique(sort_packed_un_S2,'rows','last');
num_sort_packed_un_S2 = i1_last-i1_first+1;

total_num_reads_sorted = zeros(1,length(i1_last));
for i=1:length(i1_last)
  total_num_reads_sorted(i) = sum(sorted_num_read_S2_90(i1_first(i):i1_last(i)));
end

  
[junk,i1,i2] = intersect(u_sort_packed_un_S2,S2.values(ac_related_kmers,:),'rows');
sum(total_num_reads_sorted(i1))/sum(total_num_reads_sorted)

% about 1.6808% of the raw reads are ac

%%%%%%%% end S2


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



% create xls of results
clear
S2 = load('~/CS/BAC/12Samples/Solexa/results/window_90_withNor_MergeForwardAndReverse/resWeightedMatrixBased_test_window_90_withNor_MergeForwardAndReverse_normReadsf_S2');
S1 = load('~/CS/BAC/12Samples/Solexa/results/window_90_withNor_MergeForwardAndReverse/resWeightedMatrixBased_test_window_90_withNor_MergeForwardAndReverse_normReadsf_S1');


[junk_S1,ind_S1] = sort(abs(S1.freqWeightedMatrix),'descend');
fid = fopen('~/CS/BAC/12Samples/Solexa/results/Shay/IlluminaResults_S1.xls','w');
fprintf(fid,'Header\t Frequency\n');
for i=1:length(ind_S1)
  h = [];
  for j=1:length(Header_750_tail{S1.tmpInd(ind_S1(i))})
    h = [h,Header_750_tail{S1.tmpInd(ind_S1(i))}{j},' ; '];
  end
  if junk_S1(i)>0.001
    fprintf(fid,'%s\t %1.3f\n',h,junk_S1(i));
  end
  
end
fclose(fid)


[junk_S2,ind_S2] = sort(abs(S2.freqWeightedMatrix),'descend');
fid = fopen('~/CS/BAC/12Samples/Solexa/results/Shay/IlluminaResults_S2.xls','w');
fprintf(fid,'Header\t Frequency\n');
for i=1:length(ind_S2)
  h = [];
  for j=1:length(Header_750_tail{S2.tmpInd(ind_S2(i))})
    h = [h,Header_750_tail{S2.tmpInd(ind_S2(i))}{j},' ; '];
  end
  if junk_S2(i)>0.001
    fprintf(fid,'%s\t %1.3f\n',h,junk_S2(i));
  end
  
end
fclose(fid)



% create files for RDP classification
clear
load /home/csfaculty/shental/CS/BAC/primers750_primer_tail/bac16s_primers750_primer_tail_full_without_ambiguous
load ~/CS/BAC/data750with4mm/database_16s_750primers_with4mm_full_without_ambiguous

%S2 = load('~/CS/BAC/12Samples/Solexa/results/window_90_withNor_MergeForwardAndReverse/resWeightedMatrixBased_test_window_90_withNor_MergeForwardAndReverse_normReadsf_S2');
S1 = load('~/CS/BAC/12Samples/Solexa/results/window_90_withNor_MergeForwardAndReverse/resWeightedMatrixBased_test_window_90_withNor_MergeForwardAndReverse_normReadsf_S1');

[junk_S1,ind_S1] = sort(abs(S1.freqWeightedMatrix),'descend');

ind_S1(find(junk_S1<0.001)) = [];

tmpCell = cell(length(ind_S1),1);
for i=1:length(ind_S1)
  tmpCell{i} = Header_750_tail{S1.tmpInd(ind_S1(i))}{1};
end

Fa = findSpecificBacteria(tmpCell,Header_no_nonACGT);

fileName = '~/CS/BAC/12Samples/Solexa/results/Shay/IlluminaResults_S1.fa';
delete(fileName)
writeFastaFilespecificBacteria(Fa,fileName,Sequence_no_nonACGT,Header_no_nonACGT)

% find the value of acetobacter in 

%%%% 
clear
load /home/csfaculty/shental/CS/BAC/primers750_primer_tail/bac16s_primers750_primer_tail_full_without_ambiguous
load ~/CS/BAC/data750with4mm/database_16s_750primers_with4mm_full_without_ambiguous

S2 = load('~/CS/BAC/12Samples/Solexa/results/window_90_withNor_MergeForwardAndReverse/resWeightedMatrixBased_test_window_90_withNor_MergeForwardAndReverse_normReadsf_S2');

[junk_S2,ind_S2] = sort(abs(S2.freqWeightedMatrix),'descend');

ind_S2(find(junk_S2<0.001)) = [];

tmpCell = cell(length(ind_S2),1);
for i=1:length(ind_S2)
  tmpCell{i} = Header_750_tail{S2.tmpInd(ind_S2(i))}{1};
end

Fa = findSpecificBacteria(tmpCell,Header_no_nonACGT);

fileName = '~/CS/BAC/12Samples/Solexa/results/Shay/IlluminaResults_S2.fa';
delete(fileName)
writeFastaFilespecificBacteria(Fa,fileName,Sequence_no_nonACGT,Header_no_nonACGT)


%%%%%%%%% create merged list
% create xls of results
clear
S2 = load('~/CS/BAC/12Samples/Solexa/results/window_90_withNor_MergeForwardAndReverse/resWeightedMatrixBased_test_window_90_withNor_MergeForwardAndReverse_normReadsf_S2');
S1 = load('~/CS/BAC/12Samples/Solexa/results/window_90_withNor_MergeForwardAndReverse/resWeightedMatrixBased_test_window_90_withNor_MergeForwardAndReverse_normReadsf_S1');

load /home/csfaculty/shental/CS/BAC/primers750_primer_tail/bac16s_primers750_primer_tail_full_without_ambiguous
load ~/CS/BAC/data750with4mm/database_16s_750primers_with4mm_full_without_ambiguous


[junk_S1,ind_S1] = sort(abs(S1.freqWeightedMatrix),'descend');
[junk_S2,ind_S2] = sort(abs(S2.freqWeightedMatrix),'descend');

list = unique([S1.tmpInd,S2.tmpInd]);

[junk,i1_S1,i2_S1] = intersect(list,S1.tmpInd);
[junk,i1_S2,i2_S2] = intersect(list,S2.tmpInd);

s = zeros(1,length(list));
for i=1:length(list)
  a_S1 = find(S1.tmpInd==list(i));
  if isempty(a_S1)
    val_S1 = 0;
  else
    val_S1 = abs(S1.freqWeightedMatrix(a_S1));
  end
  
  a_S2 = find(S2.tmpInd==list(i));
  if isempty(a_S2)
    val_S2 = 0;
  else
    val_S2 = abs(S2.freqWeightedMatrix(a_S2));
  end
  
  s(i) = val_S1+val_S2;
end

[junk,ind_list] = sort(s,'descend');

list = list(ind_list);


fid = fopen('~/CS/BAC/12Samples/Solexa/results/Shay/IlluminaResults_S1S2.xls','w');
fprintf(fid,'Header\t Frequency S1\t Frequency S2\n');
tmpCell = cell(1,length(list));
for i=1:length(list)
  h = [];
  for j=1:length(Header_750_tail{list(i)})
    h = [h,Header_750_tail{list(i)}{j},' ; '];
  end
  tmpCell{i} = Header_750_tail{list(i)}{1};
  
  
  a_S1 = find(S1.tmpInd==list(i));
  if isempty(a_S1)
    val_S1 = 2;
  else
    val_S1 = abs(S1.freqWeightedMatrix(a_S1));
  end
  
  a_S2 = find(S2.tmpInd==list(i));
  if isempty(a_S2)
    val_S2 = 2;
  else
    val_S2 = abs(S2.freqWeightedMatrix(a_S2));
  end
  
  if val_S2>0.001 & val_S2<2
    val_S2 = sprintf('%1.3f',val_S2);
  elseif val_S2<0.001
    val_S2 = sprintf('<0.001');
  elseif val_S2==2
    val_S2 = sprintf('-');
  else
    disp('problem')
    pause
  end
  
  if val_S1>0.001 & val_S1<2
    val_S1 = sprintf('%1.3f',val_S1);
  elseif val_S1<0.001
    val_S1 = sprintf('<0.001');
  elseif val_S1==2
    val_S1 = sprintf('-');
  else
    disp('problem')
    pause
  end
  
  fprintf(fid,'%s\t %s\t %s\n',h,val_S1,val_S2);
  
end
fclose(fid)

Fa = findSpecificBacteria(tmpCell,Header_no_nonACGT);

fileName = '~/CS/BAC/12Samples/Solexa/results/Shay/IlluminaResults_S1S2.fa';
delete(fileName)
writeFastaFilespecificBacteria(Fa,fileName,Sequence_no_nonACGT,Header_no_nonACGT)













%%%%%%%%%%%%%%%%%%%
clear
load ~/CS/BAC/bacteria_s16_data_uni

currNum = zeros(length(Header_uni),1);
for j=1:length(Header_uni)
  if mod(j,1000)==0
    j
  end
  currNumber1 = Header_uni{j};
  a = find(currNumber1==' ');
  currNumber1 = currNumber1(1:a(1)-1);
  currNum(j) = str2num(currNumber1);
end

a = find(currNum==439170)
b = find(currNum==438059)

a = Sequence_uni{a};

b = Sequence_uni{b};

%%%%%%%%%%%%%%%%%
% toy example table
clear
load('~/CS/BAC/toyExample/sim1/results/sol_test_reads750_readlen_100_noise_1_Nreads_1000000_correction_1_withCorrection_readlen_100','found')


a = find(abs(found{end})>10^-3); % assumes this was the filter

b = find(abs(found{end}(a))>10^-2);


Header750 = load('~/CS/BAC/primers750_primer_tail/bac16s_primers750_primer_tail_full_without_ambiguous');

for i=1:length(b)

  Header750.Header_750_tail{a(b(i))}
  abs(found{end}(a(b(i))))
  pause
end

% all were validated
% the false positives are:
0.03 '146252 DQ346437.2 individual-specific oral microflora during initial colonization enamel human mouth; individual 1; 4 hour biofilm clone 2.8'
0.03 '155531 AB184500.1 Streptomyces adephospholyticus str. NBRC 13811'

0.01 '439170 GQ116037.1 Topographical and Temporal Human Skin Microbiome skin axillary vault clone nbw645g12c1'
0.0128 '187798 DQ442527.1 Streptomyces melanogenes str. NRRL B-2072T'

namely 2 above 1%


%%%%%%%%%%
% Human data
% question = why is there a group that does not appear?
clear
load ~/CS/BAC/data750with4mm/database_16s_750primers_with4mm_full_without_ambiguous

a = {'364189 FM873796.1 occupant sou;393238 GQ061950.1 Topographica;237311 AM419960.1 Noma subging;50919',...
    '516705 FJ557621.1 Survey Approach Assess Endotracheal Tube Biofilms and their Origins biofilm extub',...
    '243980 AM420128.1 Noma subgingival plaque clone 401G10(oral);419923 GQ073133.1 Topographical and Te',...
    '502815 GQ006849.1 Topographical and Temporal Human Skin Microbiome skin occiput clone nbu88e07c1;45',...
    '223790 EF509061.1 Loss During Antibiotic Treatment 1 Intubated Patients Colonized Pseudomonas aerug',...
    '529136 FJ557589.1 Survey Appro;29968 AF432133.1 tongue dorsum;417057 GQ026688.1 Topographica;468282',...
    '461063 GQ058005.1 Topographical and Temporal Human;112388 AY880055.1 Prevotella sp. T05-04;571842 E',...
    '35402 AF385551.1 crevicular epithelial cells clone BE073;111426 AY880053.1 Prevotella sp. N19-22;11',...
    '519814 FJ557642.1 Survey Approach Assess Endotracheal Tube Biofilms and their Origins biofilm extub',...
    '243840 AM420123.1 Noma subgingival plaque clone 401F02(oral);130182 AY959020.1 Microbes on human va',...
    '92496 AY349397.1 human oral cavity clone GI059;576314 FJ976391.1 Interindividual healthy human oral',...
    '427242 GQ032485.1 Topographica;223881 EF510665.1 Loss During ;219179 EF510749.1 Loss During ;217497',...
    '524930 FJ558006.1 Survey Approach Assess Endotracheal Tube Biofilms and their Origins biofilm extub',...
    '380317 GQ025681.1 Topographical and Temporal Human Skin Microbiome skin antecubital fossa clone nbw',...
    '104043 AB108826.1 Prevotella salivae str. JCM 12084 EPSA11;72590 AF385512.1 tongue dorsa clone DO03',...
    '395185 GQ059406.1 Topographical and Temporal Human Skin Microbiome skin volar forearm clone nbw1227',...
    '222653 EF512000.1 Loss During Antibiotic Treatment;223076 EF511882.1 Loss During Antibiotic Treatme',...
    '420192 GQ113006.1 Topographical and Temporal Human Skin Microbiome skin antecubital fossa clone nbw',...
    '28952 AF385513.1 tongue dorsa clone DO039',...
    '220502 EF510744.1 Loss During Antibiotic Treatment 1 Intubated Patients Colonized Pseudomonas aerug',...
    '594033 EU663608.1 throughput sequencing expands microbiology spectrum brain abscess clone 9;83456 A',...
    '539347 GU470887.1 Prevotella sp. oral taxon 302 str. F0323',...
    '271710 EU137441.1 Bartonella-positive fleas: and assembly patterns Oropsylla hirsuta (prairie dog f',...
    '221666 EF511866.1 Loss During Antibiotic Treatment 1 Intubated Patients Colonized Pseudomonas aerug',...
    '257880 AM420091.1 Noma subgingival plaque clone 302E06(oral);500537 GQ009128.1 Topographical and Te',...
    '46885 AY005072.1 subgingival dental plaque clone AU126'};


F = zeros(length(a),1);
for i=1:length(a)
  i
  flag = 0;
  k = 1;
  while flag==0 && k<=length(Header_no_nonACGT)
    for j=1:length(Header_no_nonACGT{k})
      if ~isempty(findstr(Header_no_nonACGT{k}{j},a{i}))
        F(i) = [k];
        flag = 1;
      end
    end
    k = k+1;
  end
end

F = F(find(F));

S7 = load('~/CS/BAC/12Samples/Solexa/data/window_90_withNor_MergeForwardAndReverse/data_window_90_withNor_MergeForwardAndReverse_normReadsf_S7');


basicSeqNameDir = '~/CS/BAC/data750with4mm/datNoNonACGT/packed64/'
basicSeqKey = '~/CS/BAC/data750with4mm/datNoNonACGT/keyNoNonACGT_data750with4mm';
[normalizedBac values] = prepareGroupOf1000DistributedSequenceFilesOrFourth(90,F,basicSeqNameDir,basicSeqKey);

dataIn = struct;
[fracRelevantReads,sumRelevantReads] = currReadsFourth(S7.uniqueReads,S7.uniqueReads_length,values,0,dataIn);


sumRelevantReads

%%%%%%%%%%%%%%%%%%%%%%
% chromatog
clear
fileName = ['~/CS/BAC/12Samples/validation/scf_files_drosophila/5103_W--F.scf'];
[tstruct prob comments] = scfread(fileName);


clf
h = traceplot(tstruct)

name = fieldnames(h);
for i=1:length(name)
  set(h. (name{i}),'linewidth',2)
end

set(gca,'xtick',prob.peak_index,'xticklabel',prob.base,'xlim',[350 450])



%%%%%%%%%%%%%%%%%%%%%%%%%%%
clear

load ~/CS/BAC/data750with4mm/database_16s_750primers_with4mm_full_without_ambiguous


a = {'285611 EU540096.1',...
'284063 EU535069.1',...
'430203 GQ179725.1',...
'574899 FJ893113.1.',...
'279841 EU538028.1',...
'287088 EU537573.1',...
'280801 EU540584.1',...
'286488 EU537190.1',...
'208355 EF420209.1',...
'539348 FJ894064.1',...
'580324 GQ375791.1',...
'282110 EU537227.1',...
'288813 EU469571.1',...
'294070 EU469713.1',...
'542452 GU118088.1',...
'461260 GQ101038.1',...
'107636 AJ291844.1',...
'450488 GQ067258.1',...
'133198 DQ095890.1',...
'552558 GU272272.1',...
'286355 EU538866.1',...
'280914 EU538452.1',...
'311522 EU939431.1',... 
'560886 GU293168.1',... 
'332629 EU774947.1',... 
'330109 EU774989.1',... 
'281410 EU539912.1',... 
'286548 EU538487.1',... 
'282782 EU535895.1',... 
'279942 EU537217.1',... 
'143975 DQ264610.1'};

Fa = findSpecificBacteria(a,Header_no_nonACGT);

fileName = '~/CS/BAC/results_for_figure_s1_s4/listLargeGroup.fa';
delete(fileName)
writeFastaFilespecificBacteria(Fa(find(Fa)),fileName,Sequence_no_nonACGT,Header_no_nonACGT)


b={'239854 CP000826.1 ',...
'286783 EU539754.1 ',...
'579068 GQ304785.1 ',...
'128233 AY958952.1 ',...
'285542 EU539770.1 ',...
'283741 EU538418.1 '};

Fb = findSpecificBacteria(b,Header_no_nonACGT);

fileName = '~/CS/BAC/results_for_figure_s1_s4/listFirstGroup.fa';
delete(fileName)
writeFastaFileSpecificBacteria(Fb,fileName,Sequence_no_nonACGT,Header_no_nonACGT)


c = {'281894 EU537081.1',...
'280587 EU534940.1',...
'284763 EU535406.1'    };

Fc = findSpecificBacteria(c,Header_no_nonACGT);

fileName = '~/CS/BAC/results_for_figure_s1_s4/listLastGroup.fa';
delete(fileName)
writeFastaFilespecificBacteria(Fc,fileName,Sequence_no_nonACGT,Header_no_nonACGT)

    
d = {'281410 EU539912.1',...
     '286548 EU538487.1',...
'282782 EU535895.1'};
Fd = findSpecificBacteria(d,Header_no_nonACGT);

%%%%%%%%%%%%%
% from toy example:
e = {'GQ116037.1','GQ028677.1'};
Fe = findSpecificBacteria(e,Header_no_nonACGT);
find(Sequence_no_nonACGT{Fe(1)}-Sequence_no_nonACGT{Fe(2)})

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% figure 4 
clear
load ~/CS/BAC/bacteria_s16_data_uni


% 454
b={...
'546229 GU195646.1 Lactobacillus plantarum str. S7;',...
'284270 AB368910.1 Lactobacillu;282170 AB368903.1',...
'587695 GU138567.1 Lactobacillus plantarum str. LSB',...
'106977 AJ640078.1 Lactobacillus plantarum subsp. a',...
'161334 AM279762.2 Lactobacillus plantarum 2.4.',...
'583941 GU138597.1 Lactobacillus plantarum str. LSB',...
'534907 GQ461598.1 Lactobacillus plantarum str. SC2',...
'290616 EU675926.1 Lactobacillus pentosus str. C50-',...
'15163 M58827.1 Lactobacillus plantarum',...
'548471 GQ167190.1 Effects Hydraulic Retention Ti',...
'257487 EU081013.1 Lactobacillus plantarum str. B',...
'551236 GQ202837.1 Lactobacillus plantarum str. C06',...
'239854 CP000826.1 Serratia pro;180897 NZ_AAUN01',...
'286783 EU539754.1 profile human microbiota antec',...
'579068 GQ304785.1 Enterobacter;139371 DQ068815',...
'128233 AY958952.1 Microbes on human vaginal epi',...
'285611 EU540096.1 profile huma;279927 EU536753.',...
'284063 EU535069.1 profile human skin microbiota',...
'430203 GQ179725.1 Heterogeneity vaginal microbial',...
'574899 FJ893113.1 Matriptase-d;160709 DQ536514.',...
'279841 EU538028.1 profile huma;281238 EU537306.',...
'287088 EU537573.1 profile human microbiota antec',...
'280801 EU540584.1 profile huma;32498 AF205133.1',...
'286488 EU537190.1 profile human microbiota antec',...
'208355 EF420209.1 methanogenic;287259 EU535591',...
'539348 FJ894064.1 Matriptase-deficient mice exhibi',...
'580324 GQ375791.1 Pseudomonas ;382679 GQ0696',...
'282110 EU537227.1 profile huma;287737 EU460388.',...
'288813 EU469571.1 Evolution ma;294144 EU469724.',...
'294070 EU469713.1 Evolution mammals and their g',...
'542452 GU118088.1 Threatened C;428271 GQ10118',...
'461260 GQ101038.1 Topographical and Temporal H',...
'107636 AJ291844.1 Pseudomonas ;353861 EU75313',...
'450488 GQ067258.1 Topographical and Temporal H',...
'133198 DQ095890.1 Pseudomonas libanensis str. S',...
'552558 GU272272.1 library dichlorvos treatment ra',...
'286355 EU538866.1 profile huma;283589 EU537161.',...
'280914 EU538452.1 profile human microbiota antec',...
'281894 EU537081.1 profile human microbiota antec',...
'280587 EU534940.1 profile human skin microbiota',...
'4452 D30768.1 Acetobacter aceti str. JCM 7641;2729',...
'156437 DQ419970.1 Acetobacter cibinongensis Ni',...
'274161 EU096229.1 Acetobacter ;237436 EU034024.',...
'92777 AB117966.1 Acetobacter orientalis SF17-1;39',...
'325754 EU887987.1 Microbial structure hydrolytic st',...
'4421 AJ001632.1 Acetobacter pomorum str. LTH245',...
'275390 EU137480.1 Bartonella-positive fleas: and as',...
'273974 EU137491.1 Bartonella-positive fleas: and as',...
'258983 EU137473.1 Bartonella-positive fleas: and as',...
'52332 AF232234.1 Nephila clavata symbiont;30977',...
'117492 AY876253.1 Drosophila innubila symbiont',...
'130782 AY833061.1 Wolbachia pipientis str. wRi',...
'244093 EF658668.1 intracellular symbiont and other',...
'91297 AY335932.1 Phtiropsylla agenoris symbiont;9',...
'91789 AY335927.1 Craneopsylla minerva wolffheugl',...
'170818 DQ412082.2 Drosophila takahashii subgroup'...
}




% FigureS2 fasta files

Fb = zeros(length(b),1);
for i=1:length(b)
  i
  curr_b = b{i};
  c = find(curr_b==';');
  curr_b(c:end) = [];
  r = strfind(Header_uni,curr_b);
  rr = find(cellfun(@isempty,r)==0);
  if ~isempty(rr)
    Fb(i) = rr;
  end
end
find(Fb==0)

fileName = '~/CS/BAC/results_for_figure_s1_s4/454BLAST_results_L1_L2_E1_E2.fa';
delete(fileName)
writeFastaFileSpecificBacteria(Fb,fileName,Sequence_uni,Header_uni)

% Illumina
clear b Fb
b={...
'564629 GQ275107.1 gut symbionts are tightly ',...
'108447 NC_002978.6 Wolbachia endosymbiont ',...
'58371 AJ419840.1 Acetobacter aceti str. ',...
'4452 D30768.1 Acetobacter aceti str. JCM 7641',...
'274161 EU096229.1 Acetobacter pomorum str. ',...
'65495 AB086016.1 Acetobacter pasteurianus ',...
'284763 EU535406.1 profile human microbiota ',...
'311522 EU939431.1 Fecal wild pygmy loris ',...
'560886 GU293168.1 Microbial contents and ',...
'332629 EU774947.1 Evolution mammals and ',...
'330109 EU774989.1 Evolution mammals and t',...
'281410 EU539912.1 profile human microbiota ',...
'286548 EU538487.1 profile human microbiota ',...
'282782 EU535895.1 profile human microbiota ',...
'279942 EU537217.1 profile human microbiota ',...
'143975 DQ264610.1 universal microarray ',...
'285542 EU539770.1 profile human microbiota ',...
'283741 EU538418.1 profile human microbiota ',...
'542366 GQ922601.2 Lactobacillus plantarum ',...
'161334 AM279762.2 Lactobacillus plantarum ',...
'560153 FJ455519.1 Lactobacillus plantarum str. CJLP1',...
'73879 AJ272031.1 Lactobacillus plantarum str. ',...
'282170 AB368903.1 Lactobacillus plantarum str. T4-5'...
};

b = b(end:-1:1);




% FigureS2 fasta files

Fb = zeros(length(b),1);
for i=1:length(b)
  i
  curr_b = b{i};
  c = find(curr_b==';');
  curr_b(c:end) = [];
  r = strfind(Header_uni,curr_b);
  rr = find(cellfun(@isempty,r)==0);
  if ~isempty(rr)
    Fb(i) = rr;
  end
end
find(Fb==0)

fileName = '~/CS/BAC/results_for_figure_s1_s4/SHRIMP_results_L1_L2_E1_E2.fa';
delete(fileName)
writeFastaFileSpecificBacteria(Fb,fileName,Sequence_uni,Header_uni)

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% human data

% 454
clear b Fb
b={...
'524641 FJ557734.1 Survey Approach Assess Endotrach;527485 FJ55768',...
'530057 FJ558414.1 Survey Approach Assess Endotracheal Tube Biofilms',...
'505806 GQ003855.1 Topographical and Temporal Human Skin Microbi',...
'416780 GQ101150.1 Topographical and Temporal Human Skin Microbi',...
'499193 GQ010472.1 Topographical and Temporal Human Skin Microbi',...
'499246 GQ010418.1 Topographical and Temporal Human Skin Microbi',...
'50851 AF332382.1 Arthrobacter ;58299 AF543280.1 Rothia sp. st;247333',...
'572640 GU458973.1 microbiota h;105840 AY594189.1 Rothia dento;582',...
'411148 GQ061956.1 Topographical and Temporal Human Skin Microbi',...
'255212 EF683006.1 Eastern Mediterranean atmosphere;447536 GQ0847',...
'407390 GQ032885.1 Topographica;403284 GQ071969.1 Topographica;',...
'132328 AY958933.1 Microbes on human vaginal epithe;526930 FJ55773',...
'380105 GQ033030.1 Topographica;519689 FJ558360.1 Survey Appro;24',...
'448346 GQ110021.1 Topographica;435553 GQ091968.1 Topographica;',...
'453712 GQ074242.1 Topographica;526830 FJ558381.1 Survey Appro;45',...
'310034 EU705432.1 Microbial Bu;457326 GQ070742.1 Topographica;46',...
'450591 GQ073372.1 Topographical and Temporal Human Skin Microbi',...
'396365 GQ070433.1 Topographical and Temporal Human Skin Microbi',...
'438808 GQ060226.1 Topographical and Temporal Human Skin Microbi',...
'496851 GQ012816.1 Topographical and Temporal Human Skin Microbi',...
'490719 GQ018950.1 Topographical and Temporal Human Skin Microbi',...
'254347 AM420134.1 Noma subgingival plaque clone 402A06(oral);310',...
'520236 FJ557785.1 Survey Appro;439564 GQ041498.1 Topographica;46',...
'397030 GQ030462.1 Topographical and Temporal Human Skin Microbi',...
'588309 GQ505068.1 Streptococcu;260561 NC_010582.1 Streptococc;58',...
'486804 GQ022865.1 Topographical and Temporal Human;80267 AY188',...
'133788 DQ016726.2 human mouth clone 2.7;147566 DQ346439.2 indivi',...
'280965 EU540168.1 profile human microbiota antecub;272673 EU1374',...
'520823 FJ558500.1 Survey Appro;90242 AY281087.1 Streptococcus;172',...
'385958 GQ074370.1 Topographica;370919 GQ074651.1 Topographica;',...
'487851 GQ021817.1 Topographical and Temporal Human Skin Microbi',...
'443741 GQ030564.1 Topographica;384762 GQ102626.1 Topographica;',...
'384921 GQ030592.1 Topographical and Temporal Human Skin Microbi',...
'500806 GQ008862.1 Topographica;419707 GQ030942.1 Topographica;',...
'509773 FJ470594.1 Chinese human cavities healthy oral cavity clone A_',...
'519904 FJ558290.1 Survey Approach Assess Endotracheal Tube Biofilms',...
'196718 DQ795186.1 human fecal ;447655 GQ057697.1 Topographica;35',...
'432587 GQ038600.1 Topographical and Temporal Human Skin Microbi',...
'563665 FJ470573.1 Chinese human cavities healthy oral cavity clone A_',...
'498590 GQ011076.1 Topographical and Temporal Human;313015 EU76',...
'157241 AJ969451.1 Microbial bl;219589 EF511185.1 Loss During ;22048',...
'89812 AB098612.1 Terrahaemophilus aromaticivorans ;133107 DQ0888',...
'122858 AY980482.1 human rectum mucosal biopsy clone X115;411997',...
'226844 EF509678.1 Loss During Antibiotic Treatment 1 Intubated Patie',...
'204197 EF399173.1 human fecal clone SJTU_F_12_59',...
'395978 GQ109116.1 Topographical and Temporal Human Skin Microbi',...
'261499 EU137565.1 Bartonella-positive fleas: and a;343741 EU909657.1',...
'517548 FJ558093.1 Survey Appro;44852 AF224306.1 Haemophilus i;419',...
'498664 GQ011002.1 Topographical and Temporal Human Skin Microbi',...
'524892 FJ557398.1 Survey Appro;225767 EF511988.1 Loss During ;5171',...
'242939 AM420167.1 Noma subgingival plaque clone 501C06(oral',...
'365063 FM872883.1 occupant source house floor dust clone FB04B0',...
'217840 AM697371.1 sequencing libraries indoor dust;523089 FJ558354.',...
'569075 FJ823154.1 Neisseria mucosa str. TeTa;6400 AJ239279.1 Neisseri',...
'364189 FM873796.1 occupant sou;393238 GQ061950.1 Topographica;',...
'516705 FJ557621.1 Survey Approach Assess Endotracheal Tube Biofilms',...
'243980 AM420128.1 Noma subgingival plaque clone 401G10(oral);4199',...
'502815 GQ006849.1 Topographical and Temporal Human Skin Microbi',...
'223790 EF509061.1 Loss During Antibiotic Treatment 1 Intubated Patie',...
'529136 FJ557589.1 Survey Appro;29968 AF432133.1 tongue dorsum;41',...
'461063 GQ058005.1 Topographical and Temporal Human;112388 AY88',...
'35402 AF385551.1 crevicular epithelial cells clone BE073;111426 AY880',...
'519814 FJ557642.1 Survey Approach Assess Endotracheal Tube Biofilms',...
'243840 AM420123.1 Noma subgingival plaque clone 401F02(oral);130',...
'92496 AY349397.1 human oral cavity clone GI059;576314 FJ976391.1 In',...
'427242 GQ032485.1 Topographica;223881 EF510665.1 Loss During ;219',...
'524930 FJ558006.1 Survey Approach Assess Endotracheal Tube Biofilms',...
'380317 GQ025681.1 Topographical and Temporal Human Skin Microbi',...
'104043 AB108826.1 Prevotella salivae str. JCM 12084 EPSA11;72590 AF3',...
'395185 GQ059406.1 Topographical and Temporal Human Skin Microbi',...
'222653 EF512000.1 Loss During Antibiotic Treatment;223076 EF511882.',...
'420192 GQ113006.1 Topographical and Temporal Human Skin Microbi',...
'28952 AF385513.1 tongue dorsa clone DO039',...
'220502 EF510744.1 Loss During Antibiotic Treatment 1 Intubated Patie',...
'594033 EU663608.1 throughput sequencing expands microbiology spe',...
'539347 GU470887.1 Prevotella sp. oral taxon 302 str. F0323',...
'271710 EU137441.1 Bartonella-positive fleas: and assembly patterns Or',...
'221666 EF511866.1 Loss During Antibiotic Treatment 1 Intubated Patie',...
'257880 AM420091.1 Noma subgingival plaque clone 302E06(oral);500',...
'46885 AY005072.1 subgingival dental plaque clone AU126'...
};




% FigureS2 fasta files

Fb = zeros(length(b),1);
for i=1:length(b)
  i
  curr_b = b{i};
  c = find(curr_b==';');
  curr_b(c:end) = [];
  r = strfind(Header_uni,curr_b);
  rr = find(cellfun(@isempty,r)==0);
  if ~isempty(rr)
    Fb(i) = rr;
  end
end
find(Fb==0)

fileName = '~/CS/BAC/results_for_figure_o7_s10/454BLAST_results_H1_H2_H3_H4.fa';
delete(fileName)
writeFastaFileSpecificBacteria(Fb,fileName,Sequence_uni,Header_uni)


% Illumina - human
clear b Fb
b={...
'443741 GQ030564.1 Topographical and Temporal Human Skin Microbi',...
'391275 GQ057653.1 Topographical and Temporal Human Skin Microbi',...
'452803 GQ057586.1 Topographical and Temporal Human Skin Microbi',...
'467877 GQ029953.1 Topographical and Temporal Human Skin Microbi',...
'172379 DQ905177.1 human fecal clone 002C-g8;356452 EU156771.1 Str',...
'420925 GQ030441.1 Topographical and Temporal Human Skin Microbi',...
'402747 GQ047677.1 Topographical and Temporal Human Skin Microbi',...
'487851 GQ021817.1 Topographical and Temporal Human Skin Microbi',...
'106946 AB186977.1 Mariana trough hydrothermal vent water 0.2micro-',...
'449024 GQ077595.1 Topographical and Temporal Human Skin Microbi',...
'133788 DQ016726.2 human mouth clone 2.7;147566 DQ346439.2 indivi',...
'414748 GQ029994.1 Topographical and Temporal Human Skin Microbi',...
'377679 GQ073534.1 Topographical and Temporal Human Skin Microbi',...
'454080 GQ080083.1 Topographical and Temporal Human Skin Microbi',...
'500036 GQ009629.1 Topographical and Temporal Human Skin Microbi',...
'172279 DQ532146.1 Geographical Variation Microbial Burden and Space',...
'150299 DQ326694.1 Metagenomic gut microbiome healthy human stool',...
'344193 EU156787.1 Streptococcus pseudopneumoniae str. CCUG 50869;',...
'439046 GQ116264.1 Topographical and Temporal Human Skin Microbi',...
'419776 GQ068311.1 Topographical and Temporal Human Skin Microbi',...
'381508 GQ031107.1 Topographical and Temporal Human Skin Microbi',...
'490780 GQ018887.1 Topographical and Temporal Human Skin Microbi',...
'345714 EU705351.1 Microbial Burden and Analyses Phoenix Spacecraft A',...
'462062 GQ113099.1 Topographical and Temporal Human Skin Microbi',...
'446695 GQ081083.1 Topographical and Temporal Human Skin Microbi',...
'420637 GQ106797.1 Topographical and Temporal Human Skin Microbi',...
'403439 GQ030475.1 Topographical and Temporal Human Skin Microbi',...
'462166 GQ065699.1 Topographical and Temporal Human Skin Microbi',...
'441866 GQ073356.1 Topographical and Temporal Human Skin Microbi',...
'286967 EU534532.1 profile human skin microbiota ear punch biopsy fe',...
'453712 GQ074242.1 Topographical and Temporal Human Skin Microbi',...
'351798 EU557005.1 Detection microorganisms involved infectious endoc',...
'443886 GQ116369.1 Topographical and Temporal Human Skin Microbi',...
'275755 EU137611.1 Bartonella-positive fleas: and assembly patterns Oro',...
'414931 GQ108734.1 Topographical and Temporal Human Skin Microbi',...
'423251 GQ116332.1 Topographical and Temporal Human Skin Microbi',...
'389536 GQ113786.1 Topographical and Temporal Human Skin Microbi',...
'362429 FM873090.1 occupant source house floor dust clone FC03B09',...
'407381 GQ076910.1 Topographical and Temporal Human Skin Microbi',...
'205914 EF404232.1 human fecal clone SJTU_C_06_81',...
'493003 GQ016664.1 Topographical and Temporal Human Skin Microbi',...
'413657 GQ102628.1 Topographical and Temporal Human Skin Microbi',...
'370504 GQ041353.1 Topographical and Temporal Human Skin Microbi',...
'407929 GQ032481.1 Topographical and Temporal Human Skin Microbi',...
'399892 GQ073419.1 Topographical and Temporal Human Skin Microbi',...
'489461 GQ020209.1 Topographical and Temporal Human Skin Microbi',...
'361484 FM873331.1 occupant source house floor dust clone FD01H02',...
'257492 AM420261.1 Noma subgingival plaque clone 701G07(oral',...
'393823 GQ087713.1 Topographical and Temporal Human Skin Microbi',...
'389923 GQ114621.1 Topographical and Temporal Human Skin Microbi',...
'416958 GQ073695.1 Topographical and Temporal Human Skin Microbi',...
'434541 GQ031285.1 Topographical and Temporal Human Skin Microbi',...
'180175 EF108447.1 Veillonella sp. str. NVG 88cf;198240 EF108444.1 Veillo',...
'226181 EF510447.1 Loss During Antibiotic Treatment 1 Intubated Patient',...
'211721 EF399093.1 human fecal clone SJTU_F_11_45;2;127530 AY98500',...
'396318 GQ026763.1 Topographical and Temporal Human;434512 GQ026',...
'517821 FJ557579.1 Survey Approach Assess Endotracheal Tube Biofilms a',...
'566635 FJ577261.2 Oribacterium sinus str. F0268;442590 GQ057703.1 To',...
'526157 FJ557648.1 Survey Approach Assess Endotracheal Tube Biofilms a',...
'447536 GQ084768.1 Topographical and Temporal Human Skin Microbi',...
'416074 GQ096185.1 Topographical and Temporal Human Skin Microbi',...
'411148 GQ061956.1 Topographical and Temporal Human Skin Microbi',...
'499168 GQ010497.1 Topographical and Temporal Human Skin Microbi',...
'461578 GQ032248.1 Topographical and Temporal Human Skin Microbi',...
'447054 GQ087930.1 Topographical and Temporal Human Skin Microbi',...
'415463 GQ030660.1 Topographical and Temporal Human Skin Microbi',...
'470408 ACDC01000165.1 Fusobacterium sp. str. 2_1_31;502191 GQ0074',...
'108447 NC_002978.6 Wolbachia endosymbiont Drosophila melanogaste',...
'450126 GQ116279.1 Topographical and Temporal Human Skin Microbi',...
'17538 AF224299.1 Haemophilus segnis str. MCCM 00337',...
'125760 AY975706.1 human ascending colon mucosal biopsy clone Y132',...
'306322 EU762948.1 Pervasive effects antibiotic on human gut microbiota',...
'122858 AY980482.1 human rectum mucosal biopsy clone X115;349555',...
'447705 GQ102559.1 Topographical and Temporal Human Skin Microbi',...
'318488 EU762907.1 Pervasive effects antibiotic on human gut microbiota',...
'492883 GQ016784.1 Topographical and Temporal Human;221015 AM697',...
'441937 GQ073612.1 Topographical and Temporal Human Skin Microbi',...
'375840 GQ113975.1 Topographical and Temporal Human Skin Microbi',...
'365063 FM872883.1 occupant source house floor dust clone FB04B09',...
'569075 FJ823154.1 Neisseria mucosa str. TeTa;6400 AJ239279.1 Neisseria',...
'150912 DQ409137.1 Neisseria sp. str. J01',...
'446261 GQ068332.1 Topographical and Temporal Human Skin Microbi'...
};

b = b(end:-1:1);




% FigureS2 fasta files

Fb = zeros(length(b),1);
for i=1:length(b)
  i
  curr_b = b{i};
  c = find(curr_b==';');
  curr_b(c:end) = [];
  r = strfind(Header_uni,curr_b);
  rr = find(cellfun(@isempty,r)==0);
  if ~isempty(rr)
    Fb(i) = rr;
  end
end

find(Fb==0)

fileName = '~/CS/BAC/results_for_figure_o7_s10/SHRIMP_results_H1_H2_H3_H4.fa';
delete(fileName)
writeFastaFileSpecificBacteria(Fb,fileName,Sequence_uni,Header_uni)
